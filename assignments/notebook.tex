
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{9-Copy1}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{9 Clustering}\label{clustering}

    \subsection{1. DBSCAN}\label{dbscan}

Using DBSCAN iterate (for-loop) through different values of
\texttt{min\_samples} (1 to 10) and \texttt{epsilon} (.05 to .5, in
steps of .01) to find clusters in the road-data used in the Lesson and
calculate the Silohouette Coeff for \texttt{min\_samples} and
\texttt{epsilon}. Plot \textbf{\emph{one}} line plot with the multiple
lines generated from the min\_samples and epsilon values. Use a 2D array
to store the SilCoeff values, one dimension represents
\texttt{min\_samples}, the other represents epsilon.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{c+c1}{\PYZsh{} allow plots to appear in the notebook}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} notebook
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{seaborn}
         \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{14}
         \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{10.0}\PY{p}{,} \PY{l+m+mf}{5.0}\PY{p}{)}
         
         
         \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../data/3D\PYZus{}spatial\PYZus{}network.txt.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{osm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{X} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{osm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{l+m+mi}{10000}\PY{p}{)}
         \PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}60}]:}                  lat        lon
         108514324  57.116136   7.935940
         145155209  57.323512  28.719403
         139894123  57.491219  42.535347
         80477583   57.418888  19.245527
         103953351  56.871157  20.010514
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{c+c1}{\PYZsh{} K\PYZhy{}means with N clusters}
         \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{7}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
         \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{km}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} KMeans(algorithm='auto', copy\_x=True, init='k-means++', max\_iter=300,
             n\_clusters=7, n\_init=10, n\_jobs=1, precompute\_distances='auto',
             random\_state=1, tol=0.0001, verbose=0)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} review the cluster labels}
         \PY{n+nb}{set}\PY{p}{(}\PY{n}{km}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} \{0, 1, 2, 3, 4, 5, 6\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{XX} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{lat} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{lat}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{lat}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
         \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{lon} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{lon}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{lon}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{} calculate SC for K=7}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
         \PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:} 0.10349585363140311
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{DBSCAN}
          \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          
          \PY{n}{start}   \PY{o}{=} \PY{l+m+mf}{0.0}
          \PY{n}{stop}    \PY{o}{=} \PY{l+m+mf}{0.45}
          \PY{n}{step}    \PY{o}{=} \PY{l+m+mf}{0.01}
          \PY{n}{my\PYZus{}list} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{start}\PY{p}{,} \PY{n}{stop}\PY{o}{+}\PY{n}{step}\PY{p}{,} \PY{n}{step}\PY{p}{)}
          
          \PY{n}{startb}   \PY{o}{=} \PY{l+m+mi}{1}
          \PY{n}{stopb}    \PY{o}{=} \PY{l+m+mi}{10}
          \PY{n}{stepb}    \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{2} \PY{c+c1}{\PYZsh{} To scale proportionately with epsilon increments}
          \PY{n}{my\PYZus{}listb} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{startb}\PY{p}{,} \PY{n}{stopb}\PY{o}{+}\PY{n}{stepb}\PY{p}{,} \PY{n}{stepb}\PY{p}{)}
          
          
          \PY{n}{my\PYZus{}range} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{45}\PY{p}{)}
          
          \PY{n}{one} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{one}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
              
          \PY{n}{two} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{two}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
              
          \PY{n}{three} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{3} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{three}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{four} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{4} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{four}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
              
          \PY{n}{five} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{5} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{five}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{six} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{6} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{six}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{seven} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{7} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{seven}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{eight} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{8} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{eight}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{nine} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{9} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{nine}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{ten} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{05} \PY{o}{+} \PY{n}{my\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{min\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{10} \PY{o}{+} \PY{n}{my\PYZus{}listb}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
              \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{ten}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}\PY{p}{)}
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]








  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:10<07:34, 10.32s/it]







  4\%|▍         | 2/45 [00:17<06:41,  9.33s/it]







  7\%|▋         | 3/45 [00:23<05:55,  8.46s/it]







  9\%|▉         | 4/45 [00:30<05:23,  7.89s/it]







 11\%|█         | 5/45 [00:36<05:00,  7.51s/it]







 13\%|█▎        | 6/45 [00:43<04:45,  7.31s/it]







 16\%|█▌        | 7/45 [00:50<04:35,  7.25s/it]







 18\%|█▊        | 8/45 [00:58<04:30,  7.31s/it]







 20\%|██        | 9/45 [01:04<04:15,  7.10s/it]







 22\%|██▏       | 10/45 [01:11<04:02,  6.93s/it]







 24\%|██▍       | 11/45 [01:18<03:58,  7.01s/it]







 27\%|██▋       | 12/45 [01:25<03:47,  6.88s/it]







 29\%|██▉       | 13/45 [01:31<03:36,  6.76s/it]







 31\%|███       | 14/45 [01:38<03:32,  6.84s/it]







 33\%|███▎      | 15/45 [01:45<03:23,  6.79s/it]







 36\%|███▌      | 16/45 [01:52<03:15,  6.75s/it]







 38\%|███▊      | 17/45 [01:58<03:06,  6.64s/it]







 40\%|████      | 18/45 [02:04<02:56,  6.55s/it]







 42\%|████▏     | 19/45 [02:11<02:48,  6.48s/it]







 44\%|████▍     | 20/45 [02:17<02:40,  6.44s/it]







 47\%|████▋     | 21/45 [02:24<02:35,  6.48s/it]







 49\%|████▉     | 22/45 [02:33<02:48,  7.34s/it]







 51\%|█████     | 23/45 [02:40<02:37,  7.18s/it]







 53\%|█████▎    | 24/45 [02:46<02:26,  6.98s/it]







 56\%|█████▌    | 25/45 [02:53<02:17,  6.90s/it]







 58\%|█████▊    | 26/45 [03:00<02:11,  6.90s/it]







 60\%|██████    | 27/45 [03:07<02:03,  6.88s/it]







 62\%|██████▏   | 28/45 [03:14<01:56,  6.88s/it]







 64\%|██████▍   | 29/45 [03:20<01:49,  6.86s/it]







 67\%|██████▋   | 30/45 [03:26<01:39,  6.63s/it]







 69\%|██████▉   | 31/45 [03:33<01:31,  6.54s/it]







 71\%|███████   | 32/45 [03:40<01:26,  6.68s/it]







 73\%|███████▎  | 33/45 [03:46<01:19,  6.66s/it]







 76\%|███████▌  | 34/45 [03:53<01:13,  6.70s/it]







 78\%|███████▊  | 35/45 [04:00<01:06,  6.68s/it]







 80\%|████████  | 36/45 [04:07<01:02,  6.91s/it]







 82\%|████████▏ | 37/45 [04:16<00:58,  7.30s/it]







 84\%|████████▍ | 38/45 [04:22<00:49,  7.07s/it]







 87\%|████████▋ | 39/45 [04:29<00:41,  6.97s/it]







 89\%|████████▉ | 40/45 [04:36<00:34,  6.96s/it]







 91\%|█████████ | 41/45 [04:44<00:29,  7.41s/it]







 93\%|█████████▎| 42/45 [04:51<00:22,  7.33s/it]







 96\%|█████████▌| 43/45 [04:58<00:14,  7.23s/it]







 98\%|█████████▊| 44/45 [05:05<00:07,  7.08s/it]







100\%|██████████| 45/45 [05:12<00:00,  6.92s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:07<05:13,  7.12s/it]







  4\%|▍         | 2/45 [00:13<04:56,  6.89s/it]







  7\%|▋         | 3/45 [00:19<04:39,  6.65s/it]







  9\%|▉         | 4/45 [00:26<04:32,  6.65s/it]







 11\%|█         | 5/45 [00:32<04:23,  6.59s/it]







 13\%|█▎        | 6/45 [00:39<04:15,  6.56s/it]







 16\%|█▌        | 7/45 [00:45<04:07,  6.50s/it]







 18\%|█▊        | 8/45 [00:52<04:00,  6.50s/it]







 20\%|██        | 9/45 [00:58<03:52,  6.44s/it]







 22\%|██▏       | 10/45 [01:04<03:47,  6.49s/it]







 24\%|██▍       | 11/45 [01:11<03:40,  6.47s/it]







 27\%|██▋       | 12/45 [01:17<03:31,  6.42s/it]







 29\%|██▉       | 13/45 [01:24<03:24,  6.41s/it]







 31\%|███       | 14/45 [01:30<03:18,  6.41s/it]







 33\%|███▎      | 15/45 [01:36<03:11,  6.39s/it]







 36\%|███▌      | 16/45 [01:43<03:06,  6.44s/it]







 38\%|███▊      | 17/45 [01:49<03:00,  6.43s/it]







 40\%|████      | 18/45 [01:56<02:53,  6.43s/it]







 42\%|████▏     | 19/45 [02:02<02:46,  6.41s/it]







 44\%|████▍     | 20/45 [02:08<02:39,  6.38s/it]







 47\%|████▋     | 21/45 [02:15<02:37,  6.55s/it]







 49\%|████▉     | 22/45 [02:22<02:31,  6.59s/it]







 51\%|█████     | 23/45 [02:28<02:23,  6.52s/it]







 53\%|█████▎    | 24/45 [02:35<02:17,  6.56s/it]







 56\%|█████▌    | 25/45 [02:41<02:10,  6.51s/it]







 58\%|█████▊    | 26/45 [02:48<02:02,  6.47s/it]







 60\%|██████    | 27/45 [02:54<01:56,  6.47s/it]







 62\%|██████▏   | 28/45 [03:01<01:49,  6.45s/it]







 64\%|██████▍   | 29/45 [03:07<01:42,  6.43s/it]







 67\%|██████▋   | 30/45 [03:13<01:36,  6.42s/it]







 69\%|██████▉   | 31/45 [03:20<01:30,  6.47s/it]







 71\%|███████   | 32/45 [03:27<01:24,  6.50s/it]







 73\%|███████▎  | 33/45 [03:33<01:17,  6.47s/it]







 76\%|███████▌  | 34/45 [03:39<01:11,  6.46s/it]







 78\%|███████▊  | 35/45 [03:46<01:05,  6.56s/it]







 80\%|████████  | 36/45 [03:53<00:58,  6.50s/it]







 82\%|████████▏ | 37/45 [03:59<00:51,  6.49s/it]







 84\%|████████▍ | 38/45 [04:06<00:45,  6.50s/it]







 87\%|████████▋ | 39/45 [04:12<00:39,  6.62s/it]







 89\%|████████▉ | 40/45 [04:20<00:33,  6.76s/it]







 91\%|█████████ | 41/45 [04:26<00:26,  6.67s/it]







 93\%|█████████▎| 42/45 [04:33<00:20,  6.68s/it]







 96\%|█████████▌| 43/45 [04:39<00:13,  6.64s/it]







 98\%|█████████▊| 44/45 [04:46<00:06,  6.57s/it]







100\%|██████████| 45/45 [04:52<00:00,  6.58s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:06<04:40,  6.37s/it]







  4\%|▍         | 2/45 [00:12<04:29,  6.27s/it]







  7\%|▋         | 3/45 [00:18<04:23,  6.28s/it]







  9\%|▉         | 4/45 [00:25<04:21,  6.39s/it]







 11\%|█         | 5/45 [00:31<04:14,  6.35s/it]







 13\%|█▎        | 6/45 [00:38<04:08,  6.38s/it]







 16\%|█▌        | 7/45 [00:44<04:00,  6.33s/it]







 18\%|█▊        | 8/45 [00:50<03:54,  6.33s/it]







 20\%|██        | 9/45 [00:56<03:47,  6.31s/it]







 22\%|██▏       | 10/45 [01:03<03:40,  6.31s/it]







 24\%|██▍       | 11/45 [01:09<03:34,  6.30s/it]







 27\%|██▋       | 12/45 [01:15<03:27,  6.30s/it]







 29\%|██▉       | 13/45 [01:22<03:21,  6.31s/it]







 31\%|███       | 14/45 [01:28<03:15,  6.31s/it]







 33\%|███▎      | 15/45 [01:34<03:09,  6.32s/it]







 36\%|███▌      | 16/45 [01:41<03:03,  6.32s/it]







 38\%|███▊      | 17/45 [01:47<02:57,  6.32s/it]







 40\%|████      | 18/45 [01:53<02:51,  6.35s/it]







 42\%|████▏     | 19/45 [02:00<02:45,  6.35s/it]







 44\%|████▍     | 20/45 [02:06<02:39,  6.36s/it]







 47\%|████▋     | 21/45 [02:12<02:32,  6.36s/it]







 49\%|████▉     | 22/45 [02:19<02:27,  6.40s/it]







 51\%|█████     | 23/45 [02:25<02:21,  6.43s/it]







 53\%|█████▎    | 24/45 [02:32<02:14,  6.42s/it]







 56\%|█████▌    | 25/45 [02:38<02:08,  6.41s/it]







 58\%|█████▊    | 26/45 [02:45<02:02,  6.43s/it]







 60\%|██████    | 27/45 [02:51<01:55,  6.43s/it]







 62\%|██████▏   | 28/45 [02:57<01:49,  6.42s/it]







 64\%|██████▍   | 29/45 [03:04<01:42,  6.41s/it]







 67\%|██████▋   | 30/45 [03:10<01:36,  6.40s/it]







 69\%|██████▉   | 31/45 [03:17<01:29,  6.41s/it]







 71\%|███████   | 32/45 [03:23<01:23,  6.41s/it]







 73\%|███████▎  | 33/45 [03:30<01:16,  6.41s/it]







 76\%|███████▌  | 34/45 [03:36<01:10,  6.41s/it]







 78\%|███████▊  | 35/45 [03:42<01:04,  6.40s/it]







 80\%|████████  | 36/45 [03:49<00:57,  6.41s/it]







 82\%|████████▏ | 37/45 [03:55<00:51,  6.42s/it]







 84\%|████████▍ | 38/45 [04:02<00:44,  6.42s/it]







 87\%|████████▋ | 39/45 [04:08<00:38,  6.41s/it]







 89\%|████████▉ | 40/45 [04:14<00:32,  6.42s/it]







 91\%|█████████ | 41/45 [04:21<00:25,  6.44s/it]







 93\%|█████████▎| 42/45 [04:27<00:19,  6.45s/it]







 96\%|█████████▌| 43/45 [04:34<00:13,  6.50s/it]







 98\%|█████████▊| 44/45 [04:41<00:06,  6.54s/it]







100\%|██████████| 45/45 [04:47<00:00,  6.52s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:06<04:36,  6.29s/it]







  4\%|▍         | 2/45 [00:12<04:26,  6.20s/it]







  7\%|▋         | 3/45 [00:18<04:22,  6.24s/it]







  9\%|▉         | 4/45 [00:24<04:14,  6.20s/it]







 11\%|█         | 5/45 [00:30<04:07,  6.18s/it]







 13\%|█▎        | 6/45 [00:36<04:00,  6.16s/it]







 16\%|█▌        | 7/45 [00:43<03:53,  6.15s/it]







 18\%|█▊        | 8/45 [00:49<03:51,  6.25s/it]







 20\%|██        | 9/45 [00:55<03:45,  6.26s/it]







 22\%|██▏       | 10/45 [01:02<03:39,  6.26s/it]







 24\%|██▍       | 11/45 [01:08<03:33,  6.27s/it]







 27\%|██▋       | 12/45 [01:14<03:27,  6.29s/it]







 29\%|██▉       | 13/45 [01:21<03:23,  6.35s/it]







 31\%|███       | 14/45 [01:27<03:17,  6.36s/it]







 33\%|███▎      | 15/45 [01:34<03:10,  6.37s/it]







 36\%|███▌      | 16/45 [01:40<03:04,  6.35s/it]







 38\%|███▊      | 17/45 [01:46<02:57,  6.36s/it]







 40\%|████      | 18/45 [01:52<02:51,  6.34s/it]







 42\%|████▏     | 19/45 [01:59<02:45,  6.35s/it]







 44\%|████▍     | 20/45 [02:05<02:38,  6.36s/it]







 47\%|████▋     | 21/45 [02:12<02:32,  6.37s/it]







 49\%|████▉     | 22/45 [02:18<02:25,  6.35s/it]







 51\%|█████     | 23/45 [02:25<02:21,  6.43s/it]







 53\%|█████▎    | 24/45 [02:31<02:15,  6.43s/it]







 56\%|█████▌    | 25/45 [02:37<02:08,  6.42s/it]







 58\%|█████▊    | 26/45 [02:44<02:01,  6.42s/it]







 60\%|██████    | 27/45 [02:50<01:56,  6.49s/it]







 62\%|██████▏   | 28/45 [02:57<01:49,  6.46s/it]







 64\%|██████▍   | 29/45 [03:03<01:43,  6.46s/it]







 67\%|██████▋   | 30/45 [03:10<01:36,  6.45s/it]







 69\%|██████▉   | 31/45 [03:16<01:30,  6.47s/it]







 71\%|███████   | 32/45 [03:24<01:27,  6.75s/it]







 73\%|███████▎  | 33/45 [03:30<01:19,  6.65s/it]







 76\%|███████▌  | 34/45 [03:36<01:12,  6.58s/it]







 78\%|███████▊  | 35/45 [03:43<01:05,  6.52s/it]







 80\%|████████  | 36/45 [03:50<00:58,  6.55s/it]







 82\%|████████▏ | 37/45 [03:56<00:52,  6.60s/it]







 84\%|████████▍ | 38/45 [04:03<00:45,  6.55s/it]







 87\%|████████▋ | 39/45 [04:09<00:39,  6.53s/it]







 89\%|████████▉ | 40/45 [04:16<00:32,  6.53s/it]







 91\%|█████████ | 41/45 [04:23<00:26,  6.66s/it]







 93\%|█████████▎| 42/45 [04:29<00:20,  6.67s/it]







 96\%|█████████▌| 43/45 [04:36<00:13,  6.68s/it]







 98\%|█████████▊| 44/45 [04:43<00:06,  6.67s/it]







100\%|██████████| 45/45 [04:50<00:00,  6.74s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:06<04:27,  6.09s/it]







  4\%|▍         | 2/45 [00:11<04:19,  6.04s/it]







  7\%|▋         | 3/45 [00:17<04:12,  6.02s/it]







  9\%|▉         | 4/45 [00:24<04:07,  6.04s/it]







 11\%|█         | 5/45 [00:30<04:08,  6.21s/it]







 13\%|█▎        | 6/45 [00:36<04:01,  6.19s/it]







 16\%|█▌        | 7/45 [00:43<03:55,  6.19s/it]







 18\%|█▊        | 8/45 [00:49<03:49,  6.20s/it]







 20\%|██        | 9/45 [00:55<03:43,  6.21s/it]







 22\%|██▏       | 10/45 [01:02<03:41,  6.32s/it]







 24\%|██▍       | 11/45 [01:08<03:36,  6.37s/it]







 27\%|██▋       | 12/45 [01:15<03:31,  6.41s/it]







 29\%|██▉       | 13/45 [01:21<03:25,  6.44s/it]







 31\%|███       | 14/45 [01:28<03:20,  6.45s/it]







 33\%|███▎      | 15/45 [01:34<03:17,  6.58s/it]







 36\%|███▌      | 16/45 [01:41<03:10,  6.56s/it]







 38\%|███▊      | 17/45 [01:47<03:03,  6.56s/it]







 40\%|████      | 18/45 [01:54<02:57,  6.56s/it]







 42\%|████▏     | 19/45 [02:01<02:51,  6.58s/it]







 44\%|████▍     | 20/45 [02:07<02:42,  6.51s/it]







 47\%|████▋     | 21/45 [02:13<02:35,  6.47s/it]







 49\%|████▉     | 22/45 [02:20<02:28,  6.44s/it]







 51\%|█████     | 23/45 [02:26<02:21,  6.41s/it]







 53\%|█████▎    | 24/45 [02:33<02:17,  6.55s/it]







 56\%|█████▌    | 25/45 [02:39<02:10,  6.53s/it]







 58\%|█████▊    | 26/45 [02:46<02:03,  6.49s/it]







 60\%|██████    | 27/45 [02:52<01:56,  6.45s/it]







 62\%|██████▏   | 28/45 [03:01<02:03,  7.29s/it]







 64\%|██████▍   | 29/45 [03:10<02:02,  7.65s/it]







 67\%|██████▋   | 30/45 [03:17<01:51,  7.43s/it]







 69\%|██████▉   | 31/45 [03:25<01:49,  7.79s/it]







 71\%|███████   | 32/45 [03:33<01:40,  7.69s/it]







 73\%|███████▎  | 33/45 [03:40<01:29,  7.49s/it]







 76\%|███████▌  | 34/45 [03:47<01:19,  7.20s/it]







 78\%|███████▊  | 35/45 [03:53<01:09,  6.97s/it]







 80\%|████████  | 36/45 [04:00<01:01,  6.88s/it]







 82\%|████████▏ | 37/45 [04:06<00:54,  6.81s/it]







 84\%|████████▍ | 38/45 [04:13<00:47,  6.76s/it]







 87\%|████████▋ | 39/45 [04:20<00:40,  6.72s/it]







 89\%|████████▉ | 40/45 [04:27<00:34,  6.82s/it]







 91\%|█████████ | 41/45 [04:34<00:27,  6.86s/it]







 93\%|█████████▎| 42/45 [04:40<00:20,  6.74s/it]







 96\%|█████████▌| 43/45 [04:47<00:13,  6.68s/it]







 98\%|█████████▊| 44/45 [04:53<00:06,  6.61s/it]







100\%|██████████| 45/45 [05:00<00:00,  6.59s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:05<04:14,  5.79s/it]







  4\%|▍         | 2/45 [00:11<04:09,  5.81s/it]







  7\%|▋         | 3/45 [00:17<04:05,  5.85s/it]







  9\%|▉         | 4/45 [00:23<04:02,  5.91s/it]







 11\%|█         | 5/45 [00:29<04:00,  6.01s/it]







 13\%|█▎        | 6/45 [00:36<03:57,  6.09s/it]







 16\%|█▌        | 7/45 [00:42<03:51,  6.08s/it]







 18\%|█▊        | 8/45 [00:48<03:46,  6.11s/it]







 20\%|██        | 9/45 [00:54<03:40,  6.14s/it]







 22\%|██▏       | 10/45 [01:01<03:37,  6.23s/it]







 24\%|██▍       | 11/45 [01:07<03:32,  6.25s/it]







 27\%|██▋       | 12/45 [01:13<03:26,  6.27s/it]







 29\%|██▉       | 13/45 [01:19<03:21,  6.29s/it]







 31\%|███       | 14/45 [01:26<03:15,  6.30s/it]







 33\%|███▎      | 15/45 [01:32<03:12,  6.41s/it]







 36\%|███▌      | 16/45 [01:39<03:04,  6.37s/it]







 38\%|███▊      | 17/45 [01:45<02:57,  6.36s/it]







 40\%|████      | 18/45 [01:51<02:51,  6.33s/it]







 42\%|████▏     | 19/45 [01:58<02:44,  6.33s/it]







 44\%|████▍     | 20/45 [02:04<02:39,  6.37s/it]







 47\%|████▋     | 21/45 [02:11<02:33,  6.38s/it]







 49\%|████▉     | 22/45 [02:17<02:27,  6.39s/it]







 51\%|█████     | 23/45 [02:24<02:26,  6.66s/it]







 53\%|█████▎    | 24/45 [02:32<02:26,  7.00s/it]







 56\%|█████▌    | 25/45 [02:40<02:23,  7.17s/it]







 58\%|█████▊    | 26/45 [02:47<02:17,  7.22s/it]







 60\%|██████    | 27/45 [02:54<02:07,  7.10s/it]







 62\%|██████▏   | 28/45 [03:01<02:02,  7.19s/it]







 64\%|██████▍   | 29/45 [03:08<01:53,  7.07s/it]







 67\%|██████▋   | 30/45 [03:15<01:44,  6.96s/it]







 69\%|██████▉   | 31/45 [03:22<01:37,  6.93s/it]







 71\%|███████   | 32/45 [03:29<01:30,  6.96s/it]







 73\%|███████▎  | 33/45 [03:35<01:22,  6.89s/it]







 76\%|███████▌  | 34/45 [03:42<01:15,  6.88s/it]







 78\%|███████▊  | 35/45 [03:49<01:07,  6.76s/it]







 80\%|████████  | 36/45 [03:55<01:00,  6.77s/it]







 82\%|████████▏ | 37/45 [04:03<00:55,  6.91s/it]







 84\%|████████▍ | 38/45 [04:09<00:47,  6.78s/it]







 87\%|████████▋ | 39/45 [04:16<00:40,  6.69s/it]







 89\%|████████▉ | 40/45 [04:22<00:33,  6.64s/it]







 91\%|█████████ | 41/45 [04:29<00:26,  6.59s/it]







 93\%|█████████▎| 42/45 [04:36<00:20,  6.71s/it]







 96\%|█████████▌| 43/45 [04:42<00:13,  6.62s/it]







 98\%|█████████▊| 44/45 [04:48<00:06,  6.56s/it]







100\%|██████████| 45/45 [04:55<00:00,  6.54s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:05<04:17,  5.85s/it]







  4\%|▍         | 2/45 [00:11<04:11,  5.85s/it]







  7\%|▋         | 3/45 [00:17<04:07,  5.89s/it]







  9\%|▉         | 4/45 [00:23<04:02,  5.92s/it]







 11\%|█         | 5/45 [00:29<03:58,  5.96s/it]







 13\%|█▎        | 6/45 [00:36<03:59,  6.14s/it]







 16\%|█▌        | 7/45 [00:42<03:52,  6.12s/it]







 18\%|█▊        | 8/45 [00:48<03:46,  6.11s/it]







 20\%|██        | 9/45 [00:54<03:41,  6.14s/it]







 22\%|██▏       | 10/45 [01:00<03:35,  6.17s/it]







 24\%|██▍       | 11/45 [01:08<03:40,  6.48s/it]







 27\%|██▋       | 12/45 [01:15<03:46,  6.87s/it]







 29\%|██▉       | 13/45 [01:22<03:39,  6.85s/it]







 31\%|███       | 14/45 [01:29<03:28,  6.74s/it]







 33\%|███▎      | 15/45 [01:36<03:23,  6.78s/it]







 36\%|███▌      | 16/45 [01:42<03:13,  6.67s/it]







 38\%|███▊      | 17/45 [01:49<03:09,  6.76s/it]







 40\%|████      | 18/45 [01:56<03:08,  6.99s/it]







 42\%|████▏     | 19/45 [02:03<02:59,  6.91s/it]







 44\%|████▍     | 20/45 [02:10<02:49,  6.77s/it]







 47\%|████▋     | 21/45 [02:17<02:48,  7.01s/it]







 49\%|████▉     | 22/45 [02:24<02:38,  6.89s/it]







 51\%|█████     | 23/45 [02:30<02:28,  6.74s/it]







 53\%|█████▎    | 24/45 [02:37<02:22,  6.80s/it]







 56\%|█████▌    | 25/45 [02:44<02:16,  6.84s/it]







 58\%|█████▊    | 26/45 [02:51<02:08,  6.77s/it]







 60\%|██████    | 27/45 [02:57<02:00,  6.72s/it]







 62\%|██████▏   | 28/45 [03:04<01:53,  6.71s/it]







 64\%|██████▍   | 29/45 [03:11<01:47,  6.73s/it]







 67\%|██████▋   | 30/45 [03:18<01:41,  6.75s/it]







 69\%|██████▉   | 31/45 [03:24<01:34,  6.74s/it]







 71\%|███████   | 32/45 [03:31<01:27,  6.73s/it]







 73\%|███████▎  | 33/45 [03:38<01:23,  6.94s/it]







 76\%|███████▌  | 34/45 [03:45<01:16,  6.93s/it]







 78\%|███████▊  | 35/45 [03:52<01:09,  6.95s/it]







 80\%|████████  | 36/45 [03:59<01:02,  6.97s/it]







 82\%|████████▏ | 37/45 [04:07<00:57,  7.19s/it]







 84\%|████████▍ | 38/45 [04:14<00:49,  7.01s/it]







 87\%|████████▋ | 39/45 [04:21<00:42,  7.13s/it]







 89\%|████████▉ | 40/45 [04:28<00:36,  7.23s/it]







 91\%|█████████ | 41/45 [04:36<00:29,  7.27s/it]







 93\%|█████████▎| 42/45 [04:42<00:21,  7.08s/it]







 96\%|█████████▌| 43/45 [04:49<00:13,  6.98s/it]







 98\%|█████████▊| 44/45 [04:56<00:07,  7.01s/it]







100\%|██████████| 45/45 [05:04<00:00,  7.11s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:06<04:34,  6.24s/it]







  4\%|▍         | 2/45 [00:11<04:21,  6.09s/it]







  7\%|▋         | 3/45 [00:18<04:18,  6.15s/it]







  9\%|▉         | 4/45 [00:25<04:22,  6.41s/it]







 11\%|█         | 5/45 [00:32<04:20,  6.50s/it]







 13\%|█▎        | 6/45 [00:39<04:22,  6.74s/it]







 16\%|█▌        | 7/45 [00:46<04:17,  6.78s/it]







 18\%|█▊        | 8/45 [00:52<04:04,  6.61s/it]







 20\%|██        | 9/45 [00:58<03:55,  6.54s/it]







 22\%|██▏       | 10/45 [01:05<03:49,  6.55s/it]







 24\%|██▍       | 11/45 [01:11<03:40,  6.47s/it]







 27\%|██▋       | 12/45 [01:17<03:32,  6.43s/it]







 29\%|██▉       | 13/45 [01:24<03:27,  6.48s/it]







 31\%|███       | 14/45 [01:31<03:23,  6.57s/it]







 33\%|███▎      | 15/45 [01:38<03:20,  6.68s/it]







 36\%|███▌      | 16/45 [01:45<03:16,  6.79s/it]







 38\%|███▊      | 17/45 [01:52<03:14,  6.94s/it]







 40\%|████      | 18/45 [01:59<03:06,  6.91s/it]







 42\%|████▏     | 19/45 [02:06<03:03,  7.06s/it]







 44\%|████▍     | 20/45 [02:14<02:59,  7.19s/it]







 47\%|████▋     | 21/45 [02:21<02:54,  7.29s/it]







 49\%|████▉     | 22/45 [02:29<02:50,  7.40s/it]







 51\%|█████     | 23/45 [02:37<02:45,  7.52s/it]







 53\%|█████▎    | 24/45 [02:44<02:33,  7.31s/it]







 56\%|█████▌    | 25/45 [02:50<02:23,  7.17s/it]







 58\%|█████▊    | 26/45 [02:57<02:14,  7.09s/it]







 60\%|██████    | 27/45 [03:05<02:12,  7.36s/it]







 62\%|██████▏   | 28/45 [03:12<02:02,  7.21s/it]







 64\%|██████▍   | 29/45 [03:19<01:54,  7.14s/it]







 67\%|██████▋   | 30/45 [03:26<01:45,  7.02s/it]







 69\%|██████▉   | 31/45 [03:34<01:42,  7.34s/it]







 71\%|███████   | 32/45 [03:42<01:39,  7.65s/it]







 73\%|███████▎  | 33/45 [03:50<01:30,  7.55s/it]







 76\%|███████▌  | 34/45 [03:57<01:22,  7.50s/it]







 78\%|███████▊  | 35/45 [04:04<01:14,  7.46s/it]







 80\%|████████  | 36/45 [04:12<01:05,  7.33s/it]







 82\%|████████▏ | 37/45 [04:18<00:57,  7.16s/it]







 84\%|████████▍ | 38/45 [04:26<00:50,  7.24s/it]







 87\%|████████▋ | 39/45 [04:36<00:49,  8.18s/it]







 89\%|████████▉ | 40/45 [04:43<00:38,  7.79s/it]







 91\%|█████████ | 41/45 [04:50<00:30,  7.55s/it]







 93\%|█████████▎| 42/45 [04:57<00:21,  7.31s/it]







 96\%|█████████▌| 43/45 [05:04<00:14,  7.37s/it]







 98\%|█████████▊| 44/45 [05:11<00:07,  7.16s/it]







100\%|██████████| 45/45 [05:17<00:00,  6.99s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:05<04:11,  5.71s/it]







  4\%|▍         | 2/45 [00:11<04:04,  5.69s/it]







  7\%|▋         | 3/45 [00:17<04:05,  5.84s/it]







  9\%|▉         | 4/45 [00:23<04:03,  5.95s/it]







 11\%|█         | 5/45 [00:30<04:04,  6.11s/it]







 13\%|█▎        | 6/45 [00:36<04:05,  6.29s/it]







 16\%|█▌        | 7/45 [00:43<04:02,  6.39s/it]







 18\%|█▊        | 8/45 [00:50<03:59,  6.48s/it]







 20\%|██        | 9/45 [00:57<04:04,  6.80s/it]







 22\%|██▏       | 10/45 [01:04<03:55,  6.73s/it]







 24\%|██▍       | 11/45 [01:10<03:47,  6.70s/it]







 27\%|██▋       | 12/45 [01:18<03:45,  6.83s/it]







 29\%|██▉       | 13/45 [01:25<03:43,  6.99s/it]







 31\%|███       | 14/45 [01:32<03:35,  6.94s/it]







 33\%|███▎      | 15/45 [01:39<03:29,  6.99s/it]







 36\%|███▌      | 16/45 [01:46<03:24,  7.07s/it]







 38\%|███▊      | 17/45 [01:53<03:15,  6.98s/it]







 40\%|████      | 18/45 [02:00<03:09,  7.02s/it]







 42\%|████▏     | 19/45 [02:07<03:00,  6.94s/it]







 44\%|████▍     | 20/45 [02:14<02:54,  6.98s/it]







 47\%|████▋     | 21/45 [02:21<02:45,  6.90s/it]







 49\%|████▉     | 22/45 [02:28<02:38,  6.90s/it]







 51\%|█████     | 23/45 [02:34<02:29,  6.79s/it]







 53\%|█████▎    | 24/45 [02:41<02:21,  6.76s/it]







 56\%|█████▌    | 25/45 [02:48<02:18,  6.92s/it]







 58\%|█████▊    | 26/45 [02:55<02:10,  6.85s/it]







 60\%|██████    | 27/45 [03:01<02:02,  6.83s/it]







 62\%|██████▏   | 28/45 [03:08<01:57,  6.88s/it]







 64\%|██████▍   | 29/45 [03:16<01:51,  6.97s/it]







 67\%|██████▋   | 30/45 [03:22<01:43,  6.89s/it]







 69\%|██████▉   | 31/45 [03:29<01:35,  6.85s/it]







 71\%|███████   | 32/45 [03:36<01:28,  6.84s/it]







 73\%|███████▎  | 33/45 [03:43<01:21,  6.77s/it]







 76\%|███████▌  | 34/45 [03:49<01:14,  6.81s/it]







 78\%|███████▊  | 35/45 [03:57<01:10,  7.03s/it]







 80\%|████████  | 36/45 [04:04<01:02,  6.95s/it]







 82\%|████████▏ | 37/45 [04:11<00:55,  6.91s/it]







 84\%|████████▍ | 38/45 [04:18<00:49,  7.06s/it]







 87\%|████████▋ | 39/45 [04:25<00:41,  6.99s/it]







 89\%|████████▉ | 40/45 [04:32<00:34,  6.91s/it]







 91\%|█████████ | 41/45 [04:38<00:27,  6.88s/it]







 93\%|█████████▎| 42/45 [04:46<00:20,  6.99s/it]







 96\%|█████████▌| 43/45 [04:52<00:13,  6.89s/it]







 98\%|█████████▊| 44/45 [04:59<00:06,  6.97s/it]







100\%|██████████| 45/45 [05:06<00:00,  6.94s/it]















  0\%|          | 0/45 [00:00<?, ?it/s]







  2\%|▏         | 1/45 [00:05<04:20,  5.93s/it]







  4\%|▍         | 2/45 [00:11<04:14,  5.91s/it]







  7\%|▋         | 3/45 [00:17<04:08,  5.93s/it]







  9\%|▉         | 4/45 [00:23<04:04,  5.96s/it]







 11\%|█         | 5/45 [00:30<04:06,  6.17s/it]







 13\%|█▎        | 6/45 [00:37<04:10,  6.43s/it]







 16\%|█▌        | 7/45 [00:45<04:17,  6.77s/it]







 18\%|█▊        | 8/45 [00:51<04:07,  6.70s/it]







 20\%|██        | 9/45 [00:58<04:03,  6.76s/it]







 22\%|██▏       | 10/45 [01:05<03:58,  6.82s/it]







 24\%|██▍       | 11/45 [01:12<03:57,  7.00s/it]







 27\%|██▋       | 12/45 [01:19<03:51,  7.02s/it]







 29\%|██▉       | 13/45 [01:27<03:49,  7.18s/it]







 31\%|███       | 14/45 [01:34<03:39,  7.09s/it]







 33\%|███▎      | 15/45 [01:41<03:30,  7.03s/it]







 36\%|███▌      | 16/45 [01:47<03:20,  6.92s/it]







 38\%|███▊      | 17/45 [01:54<03:14,  6.94s/it]







 40\%|████      | 18/45 [02:01<03:07,  6.93s/it]







 42\%|████▏     | 19/45 [02:08<02:57,  6.82s/it]







 44\%|████▍     | 20/45 [02:15<02:53,  6.94s/it]







 47\%|████▋     | 21/45 [02:22<02:43,  6.80s/it]







 49\%|████▉     | 22/45 [02:29<02:40,  7.00s/it]







 51\%|█████     | 23/45 [02:36<02:32,  6.91s/it]







 53\%|█████▎    | 24/45 [02:42<02:21,  6.76s/it]







 56\%|█████▌    | 25/45 [02:49<02:15,  6.76s/it]







 58\%|█████▊    | 26/45 [02:56<02:08,  6.77s/it]







 60\%|██████    | 27/45 [03:03<02:02,  6.83s/it]







 62\%|██████▏   | 28/45 [03:10<01:56,  6.88s/it]







 64\%|██████▍   | 29/45 [03:17<01:50,  6.93s/it]







 67\%|██████▋   | 30/45 [03:24<01:44,  6.96s/it]







 69\%|██████▉   | 31/45 [03:32<01:42,  7.29s/it]







 71\%|███████   | 32/45 [03:38<01:32,  7.09s/it]







 73\%|███████▎  | 33/45 [03:45<01:23,  6.96s/it]







 76\%|███████▌  | 34/45 [03:52<01:15,  6.85s/it]







 78\%|███████▊  | 35/45 [03:58<01:07,  6.78s/it]







 80\%|████████  | 36/45 [04:05<01:00,  6.76s/it]







 82\%|████████▏ | 37/45 [04:12<00:53,  6.67s/it]







 84\%|████████▍ | 38/45 [04:18<00:46,  6.61s/it]







 87\%|████████▋ | 39/45 [04:25<00:39,  6.62s/it]







 89\%|████████▉ | 40/45 [04:31<00:33,  6.65s/it]







 91\%|█████████ | 41/45 [04:38<00:26,  6.60s/it]







 93\%|█████████▎| 42/45 [04:44<00:19,  6.57s/it]







 96\%|█████████▌| 43/45 [04:51<00:13,  6.55s/it]







 98\%|█████████▊| 44/45 [04:57<00:06,  6.52s/it]







100\%|██████████| 45/45 [05:04<00:00,  6.55s/it]








    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{c+c1}{\PYZsh{} plot the results}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{,} \PY{n}{one}\PY{p}{,} \PY{n}{two}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{,} \PY{n}{three}\PY{p}{,} \PY{n}{four}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{,} \PY{n}{five}\PY{p}{,} \PY{n}{six}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{,} \PY{n}{seven}\PY{p}{,} \PY{n}{eight}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{my\PYZus{}range}\PY{p}{,} \PY{n}{nine}\PY{p}{,} \PY{n}{ten}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Epsilon Increase}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silhouette Coefficient}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \subsection{2. Clustering your own data}\label{clustering-your-own-data}

Using your own data, find relevant clusters/groups within your data. If
your data is labeled already, with a class that you are attempting to
predict, be sure to not use it in fitting/training/predicting.

You may use the labels to compare with predictions to show how well the
clustering performed using one of the clustering metrics
(http://scikit-learn.org/stable/modules/clustering.html\#clustering-performance-evaluation).

If you don't have labels, use the silhouette coefficient to show
performance. Find the optimal fit for your data but you don't need to be
as exhaustive as above.

Additionally, show the clusters in 2D and 3D plots.

For bonus, try using PCA first to condense your data from N columns to
less than N.

Two items are expected: - Metric Evaluation Plot - Plots of the
clustered data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} notebook
          \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{decomposition}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{datasets}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{seaborn}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{8}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{8.0}\PY{p}{,} \PY{l+m+mf}{7.0}\PY{p}{)}
          
          \PY{n}{centers} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
          \PY{n}{wine} \PY{o}{=} \PY{n}{datasets}\PY{o}{.}\PY{n}{load\PYZus{}wine}\PY{p}{(}\PY{p}{)}
          \PY{n}{X} \PY{o}{=} \PY{n}{wine}\PY{o}{.}\PY{n}{data}
          \PY{n}{y} \PY{o}{=} \PY{n}{wine}\PY{o}{.}\PY{n}{target}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{Axes3D}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{95}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{elev}\PY{o}{=}\PY{l+m+mi}{48}\PY{p}{,} \PY{n}{azim}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{pca} \PY{o}{=} \PY{n}{decomposition}\PY{o}{.}\PY{n}{PCA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
          \PY{n}{pca}\PY{o}{.}\PY{n}{fit\PYZus{}transform}
          \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{n}{X} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{name}\PY{p}{,} \PY{n}{label} \PY{o+ow}{in} \PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{]}\PY{p}{:}
              \PY{n}{ax}\PY{o}{.}\PY{n}{text3D}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                        \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)} \PY{o}{+} \PY{l+m+mf}{1.5}\PY{p}{,}
                        \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{name}\PY{p}{,}
                        \PY{n}{horizontalalignment}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{bbox}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Reorder the labels to have colors matching the cluster results}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{choose}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{float}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{y}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Paired}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}xaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}yaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}zaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Magnesium}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Flavinoids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Alcohol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{centers} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
          \PY{n}{wine} \PY{o}{=} \PY{n}{datasets}\PY{o}{.}\PY{n}{load\PYZus{}iris}\PY{p}{(}\PY{p}{)}
          \PY{n}{X} \PY{o}{=} \PY{n}{wine}\PY{o}{.}\PY{n}{data}
          \PY{n}{y} \PY{o}{=} \PY{n}{wine}\PY{o}{.}\PY{n}{target}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{Axes3D}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{95}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{elev}\PY{o}{=}\PY{l+m+mi}{48}\PY{p}{,} \PY{n}{azim}\PY{o}{=}\PY{l+m+mi}{140}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{name}\PY{p}{,} \PY{n}{label} \PY{o+ow}{in} \PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{]}\PY{p}{:}
              \PY{n}{ax}\PY{o}{.}\PY{n}{text3D}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                        \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)} \PY{o}{+} \PY{l+m+mf}{1.5}\PY{p}{,}
                        \PY{n}{X}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{n}{label}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{name}\PY{p}{,}
                        \PY{n}{horizontalalignment}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{bbox}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{edgecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} Reorder the labels to have colors matching the cluster results}
          \PY{n}{y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{choose}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{float}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{y}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Paired}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}xaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}yaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{w\PYZus{}zaxis}\PY{o}{.}\PY{n}{set\PYZus{}ticklabels}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Magnesium}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Flavinoids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Alcohol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}171}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{12}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{8.0}\PY{p}{,} \PY{l+m+mf}{5.0}\PY{p}{)}
          
          \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../data/Credit.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{X} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Unnamed: 0}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gender}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Student}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Married}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ethnicity}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}K\PYZhy{}means with N clusters}
          \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{7}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
          \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{km}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} review the cluster labels}
          \PY{n+nb}{set}\PY{p}{(}\PY{n}{km}\PY{o}{.}\PY{n}{labels\PYZus{}}\PY{p}{)}
          
          \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{Axes3D}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{95}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{elev}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,} \PY{n}{azim}\PY{o}{=}\PY{l+m+mi}{270}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Scores are grouped in bands and by the increment of 100 until it reaches 600.}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{8.0}\PY{p}{,} \PY{l+m+mf}{20.0}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Expanded 2D view}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}172}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{8.0}\PY{p}{,} \PY{l+m+mf}{5.0}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Age and Income, not so much related among the credit data population}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}150}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} The same goes for Rating and Income}
          \PY{c+c1}{\PYZsh{} What\PYZsq{}s more interesting in this plot is that there are hollow areas between the color bands}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}173}]:} \PY{n}{XX} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Income} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Rating} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Age} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Age}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}174}]:} \PY{n}{XX} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Income} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Rating} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Age} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}175}]:} \PY{n}{XX} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Income} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Income}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Rating} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{Age} \PY{o}{\PYZhy{}} \PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{X}\PY{o}{.}\PY{n}{Age}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{N}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Age}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}176}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{Axes3D}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{95}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{elev}\PY{o}{=}\PY{l+m+mi}{48}\PY{p}{,} \PY{n}{azim}\PY{o}{=}\PY{l+m+mi}{140}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}155}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{XX}\PY{o}{.}\PY{n}{Rating}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}155}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x117d8e240>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}156}]:} <matplotlib.collections.PathCollection at 0x1a27527048>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}168}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{DBSCAN}
          \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{12}\PY{p}{)}
          \PY{n}{XX}\PY{o}{.}\PY{n}{cluster} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
          \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}168}]:} -1    400
          Name: cluster, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}158}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{Axes3D}\PY{p}{(}\PY{n}{fig}\PY{p}{,} \PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{95}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{elev}\PY{o}{=}\PY{l+m+mi}{48}\PY{p}{,} \PY{n}{azim}\PY{o}{=}\PY{l+m+mi}{140}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{cla}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}zlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Rating}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}159}]:} <matplotlib.collections.PathCollection at 0x1a2792c198>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}160}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{XX}\PY{o}{.}\PY{n}{Income}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{Age}\PY{p}{,} \PY{n}{s}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}160}]:} <matplotlib.collections.PathCollection at 0x1a28998780>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}177}]:} \PY{c+c1}{\PYZsh{} calculate SC for K=7}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
          \PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}177}]:} 0.0736170561074945
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}178}]:} \PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{XX}\PY{o}{.}\PY{n}{cluster}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}178}]:} 0.3183053475041708
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}179}]:} \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
          
          \PY{c+c1}{\PYZsh{} calculate SC for K=2 through K=19}
          \PY{n}{k\PYZus{}range} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{)}
          \PY{n}{scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{k\PYZus{}range}\PY{p}{)}\PY{p}{:}
              \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{k}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{labels} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{silhouette\PYZus{}score}\PY{p}{(}\PY{n}{XX}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Income}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]








  0\%|          | 0/38 [00:00<?, ?it/s]







  8\%|▊         | 3/38 [00:00<00:01, 28.77it/s]







 13\%|█▎        | 5/38 [00:00<00:01, 23.87it/s]







 18\%|█▊        | 7/38 [00:00<00:01, 20.89it/s]







 24\%|██▎       | 9/38 [00:00<00:01, 19.02it/s]







 29\%|██▉       | 11/38 [00:00<00:01, 16.90it/s]







 34\%|███▍      | 13/38 [00:00<00:01, 14.91it/s]







 39\%|███▉      | 15/38 [00:00<00:01, 14.17it/s]







 45\%|████▍     | 17/38 [00:01<00:01, 12.22it/s]







 50\%|█████     | 19/38 [00:01<00:01, 11.08it/s]







 55\%|█████▌    | 21/38 [00:01<00:01, 10.25it/s]







 61\%|██████    | 23/38 [00:01<00:01,  9.77it/s]







 63\%|██████▎   | 24/38 [00:01<00:01,  9.32it/s]







 66\%|██████▌   | 25/38 [00:02<00:01,  8.92it/s]







 68\%|██████▊   | 26/38 [00:02<00:01,  8.41it/s]







 71\%|███████   | 27/38 [00:02<00:01,  7.72it/s]







 74\%|███████▎  | 28/38 [00:02<00:01,  7.15it/s]







 76\%|███████▋  | 29/38 [00:02<00:01,  6.70it/s]







 79\%|███████▉  | 30/38 [00:02<00:01,  6.25it/s]







 82\%|████████▏ | 31/38 [00:03<00:01,  6.10it/s]







 84\%|████████▍ | 32/38 [00:03<00:00,  6.10it/s]







 87\%|████████▋ | 33/38 [00:03<00:00,  6.04it/s]







 89\%|████████▉ | 34/38 [00:03<00:00,  5.72it/s]







 92\%|█████████▏| 35/38 [00:03<00:00,  5.30it/s]







 95\%|█████████▍| 36/38 [00:04<00:00,  5.29it/s]







 97\%|█████████▋| 37/38 [00:04<00:00,  5.26it/s]







100\%|██████████| 38/38 [00:04<00:00,  5.24it/s]








    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}180}]:} \PY{c+c1}{\PYZsh{} plot the results}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{k\PYZus{}range}\PY{p}{,} \PY{n}{scores}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of clusters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silhouette Coefficient}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.core.display.Javascript object>
    \end{verbatim}

    
    
    \begin{verbatim}
<IPython.core.display.HTML object>
    \end{verbatim}

    
    \subsection{Note}\label{note}

You may use any for both parts 1 and 2, I only recommend using the data
I used in the Lesson for part 1. I've included several new datasets in
the \texttt{data/} folder, such as \texttt{beers.csv},
\texttt{snow\_tweets.csv}, \texttt{data/USCensus1990.data.txt.gz}. You
do not need to unzip or ungzip any data files. Pandas can open these
files on its own.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
